   SCRUM Land/Sea Masking:
   ======================
 
   HOST:       ahab.rutgers.edu [128.6.142.5]
   DIRECTORY:  /ftp/pub/scrum/matlab/mask
   VERSION:    3.0
   ORIGIN:     Institute of Marine and Coastal Sciences
               Rutgers University
               New Brunswick, NJ, USA
   DEVELOPERS: Hernan G. Arango (arango@ahab.rutgers.edu)
               Patrick J. Haley (haley@pacific.harvard.edu)


  INTRODUCTION
  ============

  This directory contains SCRUM Land/Sea mask package.  It appends or
  modifies the Land/Sea mask data on RHO-, U-, V-, and PSI-points to a
  existing GRID NetCDF file.

  The Land/Sea data is first computed from the raw bathymetry, contained
  in the GRID NetCDF, by specifying a transition isobath (said zero meters)
  between Land and Sea.  The mask data is determined on the density points
  and other mask data (U-, V-, and PSI-points) are derived from it.  Recall
  that SCRUM has a staggered C-grid, so momentum components and tracer
  variables are located differently.

  The Land/Sea mask data consist of the following NetCDF variables:

      mask_rho   Land/Sea mask on density points (real matrix of
                 size 0:L by 0:M)
                   mask_rho=0.0  -> Land point.
                   mask_rho=1.0  -> Sea point.
      mask_u     Land/Sea mask on U-points (real matrix of size
                 L by 0:M)
                   mask_u=0.0    -> Land point.
                   mask_u=1.0    -> Sea point.
      mask_v     Land/Sea mask on V-points (real matrix of size
                 0:L by M)
                   mask_v=0.0    -> Land point.
                   mask_v=1.0    -> Sea point.
      mask_psi   Land/Sea mask on PSI-points (real matrix of size
                 L by M)
                   mask_psi=0.0  -> Land point.
                   mask_psi=1.0  -> Sea point.

  If the above variables are not found in the provided GRID NetCDF, this
  package will define and write them.  Contrarily, if the above variables
  already exist in the provided GRID NetCDF file, this package will
  over-write their values with the new ones.  The mask on PSI-points is
  only used when the biharmonic mixing is activated;  their values are
  again modified, internally in SCRUM, to satisfy free-slip or no-slip
  boundary conditions.


  Matlab M-Files:
  ==============

  This package contains the following Matlab scripts:

  Driver:
 
    scrum_mask   - Processes SCRUM Land/Sea mask data.
 
  Input/Output:
 
    read_mask    - Reads in Land/Sea mask data from GRID NetCDF file.
    write_mask   - Writes out Land/Sea mask data into GRID NetCDF file.
    rcoastline   - Reads in coastline data file.
 
  Land/Sea mask:
 
    set_mask     - Sets Land/Sea mask data on RHO-points.
    uvp_masks    - Computes the Land/Sea mask data on U-, V-, and PSI-points.
 
  Graphic Interface:
 
    mask_uifn    - Initializes and controls graphic buttons.
    get_hand     - Gets handles to buttons from figure's UserData matrix.
    get_states   - Gets state flags from figure's UserData matrix.
    put_states   - Puts new state flag values into figure's UserData matrix.
    radchk       - Maintains mutual exclusivity of grouped radio buttons.
 
  Orthogonal Grid Coordinate Manipulation:
 
    ijgrid       - Finds closest (I,J) grid index to a point (XP,YP).
    prange       - Defines closed polygon and finds if (XP,YP) is inside.
    inside       - Finds if (XP,YP) is inside of defined polygon.
 
  Miscellaneous:
 
    pltmask      - Plots Land/Sea mask.
    read_uvpgrid - Reads in positions on U-, V-, and PSI-points.
    draw_cstp    - Draws coastlines. 
    date_stamp   - Current date/time stamp.
    day_code     - Determines numerical value for day of week from date.


  Execution:
  =========

  In order to execute, in a Matlab session, any of the scripts documented
  here, the User needs to copy these M-files and set the environmental
  MATHLABPATH in the ".cshrc" file.  This will allow the User to execute
  these scripts from any directory.
 
  For instance, my ".cshrc" has:
 
     setenv SCRUMHOME  /home/arango/scrum3.0
     setenv MATLABPATH "$SCRUMHOME/matlab/mexcdf:$SCRUMHOME/matlab/Seawater:$SC
RUMHOME/matlab/mask:$SCRUMHOME/matlab/tools"

  In addition, the User needs to install the MEXCDF interface between
  Matlab and NetCDF files.  A copy of the MEXCDF utility (without the
  machine dependent mex-file binary) is provided here in directory 
  "/ftp/pub/scrum/matlab/mexcdf" or can be obtained via FTP anonymous
  from:

                    host: crusty.er.usgs.gov
                    file: pub/mexcdf/README

  To execute the "scrum_mask" script, use the following command after
  invoking Matlab:

  > scrum_mask

  The User will be asked interactively to enter all the necessary
  information.

  For Example:

   > Enter GRID NetCDF file name:  

     If the read masking on RHO-points is constant (all ones or zeros),
     this package will ask the User:

   > Enter transition isobath (+/- meters) between land and sea points [0]:

     If the spherical set-up switch is on in the GRID NetCDF file, this
     package will ask the User:

   > Enter coastline (lat,lon) data file name:

     The coastline file is an ASCII file containing a two column vector
     of the latitude and longitudes of each coastline segment. South
     latitudes and west longitudes are negative.  The coastline segments
     are assumed to by divided by a special value (999.0).  The data set
     is assumed to begin and end with this special values.

  Then, the package will display the following instructions:

 
   ---------------------------------------------------------------------
   ------------------- Processing Land/Sea Mask Data -------------------
   ---------------------------------------------------------------------

   Please wait a moment...

   ---------------------------------------------------------------------

   The newly created figure displays the current land mask with the
   following symbols:

      red  circles =>  Land points
      blue circles =>  Open sea points

   Land and Open sea points may be modified using this tool. Boundary
   sea points are derived from the Land points.  Use the following
   guidelines in setting the mask:

    -- Channels and bays should be at least 2 open sea points wide.

    -- Boundary sea points must touch both land and open sea points.

    -- Open sea points must touch only boundary sea and open sea points.

   ---------------------------------------------------------------------

   Carefully select mask points to change:

     Use the LEFT mouse button to select a single point or
        two opposing corners of a rectangle for an area to change.
     Use the MIDDLE mouse button to select two opposing
        corners of an area for zooming.
     Use the RIGHT mouse button to unzoom.

     Use the cyan graph buttons to change from flipping to
           filling with land or sea.

     Use the yellow graph buttons to select between changing
           a point or an entire area.

     Use the purple graph button to cancel an area
           manipulation or zoom-in operation.

     When done, use the green graph button to stop.

     To abort: use the red graph bottom.


   NOTES/RECOMMENDATIONS:
   =====================

   (1)  The efficiency of this package depends in the size of the model
        domain.  Large domains will slow down Matlab graphic's controls
        functions. So be patience.

   (2)  If modifying a very complicated Land/Sea mask boundary, it is
        always good idea to have a saved copy of the GRID NetCDF file.
        Recall, that this package will over-write existing values in
        the GRID NetCDF file.

   (3)  When modifying Land/Sea points, always put the circle symbol
        in the upper-right quadrant of cross-cursor.
